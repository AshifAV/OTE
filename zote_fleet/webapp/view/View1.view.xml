<mvc:View
    controllerName="zotefleet.controller.View1"
    xmlns="sap.m"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:layout="sap.ui.layout"
    xmlns:core="sap.ui.core"
    displayBlock="true"
>
    <App>
        <pages>
            <Page
                title="Fleet Management - Update Registration"
                showNavButton="false"
                class="sapUiNoContentPadding"
            >
                <content>
                    <!-- Main Container -->
                    <VBox alignItems="Center" class="sapUiMediumMargin">
                        <!-- Main Panel -->
                        <Panel
                            headerText="Vehicle Registration Update"
                            expandable="false"
                            width="1000px"
                            class="modern-panel"
                        >
                            <content>
                                <VBox class="sapUiSmallMargin">
                                    <!-- Search Section -->
                                    <HBox alignItems="Center" justifyContent="SpaceBetween" 
                                          class="sapUiSmallMarginBottom search-section">
                                        <VBox class="search-field">
                                            <Label text="Customer" 
                                                   design="Bold" class="sapUiTinyMarginBottom"/>
                                            <HBox alignItems="Center">
                                                <Input
                                                    id="idCustomer"
                                                    valueHelpRequest=".onCustomerValueHelp"
                                                    valueHelpOnly="true"
                                                    showValueHelp="true"
                                                    width="180px"
                                                    placeholder="Select customer"
                                                    class="sapUiSmallMarginEnd"
                                                    change=".onCustomerChange"
                                                />
                                                <core:Icon
                                                    src="sap-icon://value-help"
                                                    size="1.25rem"
                                                    color="#0a6ed1"
                                                    class="sapUiTinyMarginBegin"
                                                />
                                            </HBox>
                                            <Text
                                                id="idCustomerName"
                                                text="No customer selected"
                                                wrapping="true"
                                                class="sapUiTinyMarginTop"
                                            />
                                        </VBox>
                                        
                                        <VBox class="search-field">
                                            <Label text="Equipment" 
                                                   design="Bold" class="sapUiTinyMarginBottom"/>
                                            <HBox alignItems="Center">
                                                <Input
                                                    id="idEquipment"
                                                    valueHelpRequest=".onEquipmentValueHelp"
                                                    valueHelpOnly="true"
                                                    showValueHelp="true"
                                                    width="180px"
                                                    placeholder="Select equipment"
                                                    class="sapUiSmallMarginEnd"
                                                    change=".onEquipmentChange"
                                                />
                                                <core:Icon
                                                    src="sap-icon://value-help"
                                                    size="1.25rem"
                                                    color="#0a6ed1"
                                                    class="sapUiTinyMarginBegin"
                                                />
                                            </HBox>
                                            <Text
                                                id="idEquipmentDescription"
                                                text="No equipment selected"
                                                wrapping="true"
                                                class="sapUiTinyMarginTop"
                                            />
                                        </VBox>
                                        
                                        <VBox class="search-field">
                                            <Label text="VIN/Chassis Number" 
                                                   design="Bold" class="sapUiTinyMarginBottom"/>
                                            <HBox alignItems="Center">
                                                <Input
                                                    id="idVINSearch"
                                                    valueHelpRequest=".onVINValueHelp"
                                                    valueHelpOnly="true"
                                                    showValueHelp="true"
                                                    width="180px"
                                                    placeholder="Search by VIN"
                                                    class="sapUiSmallMarginEnd"
                                                    change=".onVINChange"
                                                />
                                                <core:Icon
                                                    src="sap-icon://value-help"
                                                    size="1.25rem"
                                                    color="#0a6ed1"
                                                    class="sapUiTinyMarginBegin"
                                                />
                                            </HBox>
                                            <Text
                                                id="idVINDescription"
                                                text="Search by VIN/Chassis number"
                                                wrapping="true"
                                                class="sapUiTinyMarginTop"
                                            />
                                        </VBox>
                                        
                                        <VBox class="action-buttons">
                                            <Button
                                                text="Clear Filters"
                                                press=".onClearFiltersPress"
                                                width="120px"
                                                icon="sap-icon://clear-filter"
                                                class="sapUiTinyMarginTop"
                                            />
                                            <Button
                                                text="Refresh"
                                                press=".onRefreshPress"
                                                width="120px"
                                                icon="sap-icon://refresh"
                                                class="sapUiTinyMarginTop"
                                            />
                                        </VBox>
                                    </HBox>

                                    <!-- Table Section -->
                                    <VBox class="sapUiSmallMarginTop">
                                        <Table
                                            id="idEquipmentTable"
                                            items="{
                                                path: 'table>/equipmentItems',
                                                sorter: {
                                                    path: 'equnr',
                                                    descending: false
                                                }
                                            }"
                                            mode="SingleSelectMaster"
                                            selectionChange=".onTableItemPress"
                                            class="equipment-table"
                                        >
                                            <headerToolbar>
                                                <OverflowToolbar>
                                                    <Title text="Vehicle Details" level="H2"/>
                                                    <ToolbarSpacer/>
                                                    <Label text="Search Mode:" class="sapUiTinyMarginEnd"/>
                                                    <Select
                                                        id="idSearchMode"
                                                        selectedKey="customer"
                                                        change=".onSearchModeChange"
                                                        width="140px">
                                                        <core:Item key="customer" text="Customer"/>
                                                        <core:Item key="equipment" text="Equipment"/>
                                                        <core:Item key="vin" text="VIN"/>
                                                    </Select>
                                                    <Button 
                                                        id="idUpdateButton"
                                                        text="Update Selected"
                                                        press=".onUpdateSelectedPress"
                                                        type="Accept"
                                                        icon="sap-icon://save"
                                                        enabled="false"
                                                        class="sapUiTinyMarginBegin"/>
                                                    <Text text="{= ${table>/equipmentItems}.length || 0 } item(s)"/>
                                                </OverflowToolbar>
                                            </headerToolbar>
                                            <columns>
                                                <Column width="15%">
                                                    <Text text="Equipment"/>
                                                </Column>
                                                <Column width="20%">
                                                    <Text text="Description"/>
                                                </Column>
                                                <Column width="15%">
                                                    <Text text="Customer"/>
                                                </Column>
                                                <Column width="20%">
                                                    <Text text="VIN/Chassis"/>
                                                </Column>
                                                <Column width="15%">
                                                    <Text text="Plate Number"/>
                                                </Column>
                                            </columns>
                                            <items>
                                                <ColumnListItem type="Active">
                                                    <cells>
                                                        <Text text="{
                                                            path: 'table>equnr',
                                                            formatter: '.formatEquipmentNoLeadingZeros'
                                                        }"/>
                                                        <Text text="{table>eqktx}"/>
                                                        <Text text="{table>name1}"/>
                                                        <Text text="{table>fleetVin}"/>
                                                        <Input 
                                                            value="{table>licenseNum}"
                                                            change=".onPlateNumberChange"
                                                            placeholder="Enter plate number"
                                                            width="100%"
                                                            editable="{table>editable}"/>
                                                    </cells>
                                                </ColumnListItem>
                                            </items>
                                            <noData>
                                                <IllustratedMessage
                                                    title="No Vehicles Found"
                                                    description="Select a search criteria to view details"
                                                    illustrationType="sapIllus-EmptyList">
                                                    <additionalContent>
                                                        <Button
                                                            text="Select Customer"
                                                            press=".onSelectCustomerHelp"
                                                            icon="sap-icon://customer"
                                                            class="sapUiTinyMarginEnd"/>
                                                        <Button
                                                            text="Select Equipment"
                                                            press=".onSelectEquipmentHelp"
                                                            icon="sap-icon://machine"
                                                            class="sapUiTinyMarginEnd"/>
                                                        <Button
                                                            text="Search by VIN"
                                                            press=".onSelectVINHelp"
                                                            icon="sap-icon://search"/>
                                                    </additionalContent>
                                                </IllustratedMessage>
                                            </noData>
                                        </Table>
                                    </VBox>

                                    <!-- Status and Action Section -->
                                    <HBox justifyContent="SpaceBetween" alignItems="Center" 
                                          class="sapUiSmallMarginTop status-section">
                                        <VBox>
                                            <MessageStrip
                                                id="idStatusMessage"
                                                type="Information"
                                                showIcon="true"
                                                showCloseButton="true"
                                                visible="false"
                                                class="status-message"
                                            />
                                        </VBox>
                                        <HBox>
                                            <Button
                                                id="idBatchUpdateButton"
                                                text="Update All Changes"
                                                press=".onBatchUpdatePress"
                                                type="Emphasized"
                                                icon="sap-icon://save"
                                                enabled="false"
                                                class="sapUiTinyMarginEnd"
                                            />
                                            <Button
                                                text="Clear All"
                                                press=".onClearAllPress"
                                                width="100px"
                                                icon="sap-icon://delete"
                                            />
                                        </HBox>
                                    </HBox>
                                </VBox>
                            </content>
                        </Panel>
                    </VBox>
                </content>
            </Page>
        </pages>
    </App>
</mvc:View>